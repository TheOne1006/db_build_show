"use strict";angular.module("databaseDictionaryBuildApp.services",["ngResource"]),angular.module("databaseDictionaryBuildApp.controllers",["databaseDictionaryBuildApp.services"]),angular.module("databaseDictionaryBuildApp.filters",[]),angular.module("databaseDictionaryBuildApp.router",["ui.router"]),angular.module("ui.flat",[]),angular.module("databaseDictionaryBuildApp",["ngAnimate","ngCookies","ngResource","ngSanitize","ui.router","databaseDictionaryBuildApp.controllers","databaseDictionaryBuildApp.services","databaseDictionaryBuildApp.filters","databaseDictionaryBuildApp.router","ui.flat","ui.codemirror"]),angular.module("databaseDictionaryBuildApp.router").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("main",{url:"","abstract":!0}).state("main.index",{url:"/",views:{"@":{templateUrl:"views/main.html",controller:"TablesCtrl"}}}).state("main.table",{url:"/table/:tbName",views:{"@":{templateUrl:"views/table.html",controller:"TableCtrl"}}}).state("about",{url:"/about",views:{"@":{templateUrl:"views/about.html",controller:"AboutCtrl"}}}).state("help",{url:"/help",views:{"@":{templateUrl:"views/help.html",controller:"HelpCtrl"}}}),t.otherwise("/")}]),angular.module("ui.flat").directive("fuiSearchGroup",function(){return{restrict:"AE",replace:"true",template:'<div class="form-group" ><div class="input-group" ng-class={"focus":focus}><input class="form-control" type="search" placeholder="表名" ng-focus="handleFocus()" ng-blur="handleBlur()" ng-model="model" ng-model-options="{ debounce: 500 }"><span class="input-group-btn"><button type="submit" class="btn"><span class="fui-search"></span></button></span></div></div>',scope:{model:"="},link:function(e,t,a){e.focus=!1,e.handleFocus=function(){e.focus=!0},e.handleBlur=function(){e.focus=!1}}}}),angular.module("databaseDictionaryBuildApp.filters").filter("filterTable",["$filter",function(e){var t=/[\u4e00-\u9fa5]/;return function(a,r){if(!angular.isArray(a)||0===a.length||!angular.isString(r)||""===r)return a;var l,n,o="all",i=[];return t.test(r)&&(o="tableComment"),l=".*?"+r.split("").join(".*?")+".*?",n=new RegExp(l,"i"),angular.forEach(a,function(t){var a=t.Name,l=t.Comment||"",u=angular.extend({},t),s=!1;"tableName"!==o&&n.test(l)&&(s=!0,u.wrapComment=e("strWrapEle")(l,r,"b")),"tableComment"!==o&&n.test(a)&&(s=!0,u.wrapName=e("strWrapEle")(a,r,"b")),s&&i.push(u)}),i}}]),angular.module("databaseDictionaryBuildApp.filters").filter("strWrapEle",[function(){return function(e,t,a){for(var r,l=e.split(""),n=t.split(""),o=l.length,i=n.length,u=0,s=0,c=0;i>u;u++)for(s=c;o>s;s++)if(l[s]===n[u]){a&&(l[s]="<"+a+">"+l[s]+"</"+a+">"),c=++s;break}return r=l.join("")}}]),angular.module("databaseDictionaryBuildApp.controllers").controller("MainCtrl",["$scope",function(e){e.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma1"],e.keyWorld="",e.simpleModel=!1,e.$watch("keyWorld",function(t){e.$broadcast("changKeyWord",t)}),e.$watch("simpleModel",function(t){e.$broadcast("modelChange",t)}),e.$on("$viewContentLoaded",function(){e.keyWorld&&e.$broadcast("changKeyWord",e.keyWorld),e.$broadcast("modelChange",e.simpleModel)})}]),angular.module("databaseDictionaryBuildApp.controllers").controller("AboutCtrl",["$scope",function(e){e.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("databaseDictionaryBuildApp.controllers").controller("TablesCtrl",["$scope","$filter","TablesService",function(e,t,a){e.list=[],e.simpleModel=!1,a.get().$promise.then(function(t){e.list=t}),e.$on("changKeyWord",function(r,l){a.get().$promise.then(function(a){var r=t("filterTable")(a,l);e.list=r})}),e.$on("modelChange",function(t,a){e.simpleModel=a})}]),angular.module("databaseDictionaryBuildApp.controllers").controller("TableCtrl",["$scope","$stateParams","TableService",function(e,t,a){e.showSql=!1,e.table={},e.sqlCreate="",a.get(t.tbName).$promise.then(function(t){e.table=t}),a.getSql(t.tbName).$promise.then(function(t){e.sqlCreate=t})}]),angular.module("databaseDictionaryBuildApp.controllers").controller("HelpCtrl",["$scope",function(e){}]),angular.module("databaseDictionaryBuildApp.services").factory("TablesService",["$resource","$q",function(e,t){var a=[],r=e("/data/all_tables.json",null,{timeout:2e4}),l=function(){if(0===a.length)return r.query(null,function(e){a=e});var e=t.defer();return e.resolve(a),{$promise:e.promise}};return{get:l,gets:function(){return["1","2"]}}}]),angular.module("databaseDictionaryBuildApp.services").factory("TableService",["$resource","$http","$q",function(e,t,a){var r={},l={},n=function(t){return r[t]||(r[t]=e("/data/table_info/"+t+".json",null,{timeout:2e4})),r[t]},o=function(e,a){t.get("/data/sql/"+e+".sql").success(function(e){a.resolve(e)})};return{get:function(e){return n(e).get(null,function(t){t&&(l[e]=t)})},getSql:function(e){var t=a.defer();return o(e,t),{$promise:t.promise}}}}]);